<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic|Raleway' rel='stylesheet' type='text/css'>
    <title>Common Testing Mistakes: Testing Code That Isn't Yours - Lee Dohm's Blog</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="alternate" type="application/atom+xml" href="/feed.xml"/>
    <link rel="icon" type="image/png" href="/favicon-icon.png"/>

    <!-- Bootstrap -->
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen" />

    <!-- Site -->
    <link href="/stylesheets/styles.css" rel="stylesheet" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- MathJax -->
    <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-17382346-2', 'lee-dohm.com');
  ga('send', 'pageview');

</script>
    <meta property="og:title" content="Common Testing Mistakes: Testing Code That Isn't Yours"/>
<meta property="og:type" content="article"/>
<meta property="og:url" content="http://www.lee-dohm.com/2015/10/16/common-testing-mistakes-testing-code-that-isnt-yours/"/>
<meta property="og:image" content="http://www.lee-dohm.com/favicon-icon.png"/>
<meta property="og:description" content=""/>


    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="../../assets/js/html5shiv.js"></script>
      <script src="../../assets/js/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <nav class="navbar navbar-custom" role="navigation">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">Lee Dohm</a>
        <p class="navbar-text">Games and Technology Should Include EVERYone</p>
      </div>

      <div class="collapse navbar-collapse navbar-ex1-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="/archives">Archive</a></li>
          <li><a href="/feed.xml">Feed</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="/about">About Lee</a></li>
              <li><a href="/this-blog">About This Blog</a></li>
              <li><a href="/appearances">Appearances</a></li>
              <li><a href="/colophon">Colophon</a></li>
              <li><a href="/disclaimer">Disclaimers</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container">
      <div class="row">
        <div class="row">
          <div class="col-md-8 col-md-offset-2">
            <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<div class="content">
  <h1><a class="title" href="/2015/10/16/common-testing-mistakes-testing-code-that-isnt-yours/"><p>Common Testing Mistakes: Testing Code That Isn’t Yours</p>
</a></h1>
  <h4 class="dateline">
    October 16, 2015
    •
    <a href="/2015/10/16/common-testing-mistakes-testing-code-that-isnt-yours/"><span class="octicon octicon-link"></span></a>
  </h4>

  <p>A phase that it seems all people learning to write tests for their code go through, myself included at one point, is “falling down the test rabbit hole”. During this phase the new tester believes that the only truly valid test is a test that validates that absolutely everything happens the way that it is expected. There are a couple problems with this approach, one is that you’re doing work with no reward and the other is that it can make your tests more brittle, in other words less resilient in the face of change. So the rabbit-hole tester creates tests that have no benefit and yet can have a significant cost in maintenance.</p>

<p>Let’s take for example that we have a typical web application that performs your standard CRUD<sup id="fnref1"><a href="#fn1" rel="footnote">1</a></sup> actions on database records of some sort. We need to test that when someone goes to the website, presses the “New Record” button, fills in the form and presses “Save” that the appropriate new record is created. The rabbit-hole tester might suggest that we need to test:</p>

<ul>
<li>That the table in the database has a new record</li>
<li>That the new record in the database has the expected ID</li>
<li>That the new record in the database has the expected values in the expected columns</li>
</ul>

<p>This is testing code that isn’t yours because you’re no longer verifying that your code works, you’re verifying that the database works.<sup id="fnref2"><a href="#fn2" rel="footnote">2</a></sup> The problem with the three rabbit-hole tests above is that it tests things that:</p>

<ol>
<li>We don’t actually care about</li>
<li>If the implementation details change, our tests will break until they are updated for the new implementation</li>
</ol>

<p>So how do we properly test this? We test that the <em>application</em> behaves the way we expect:</p>

<ul>
<li>That we can query for the record and find it</li>
<li>That the record we find has the values we expect</li>
</ul>

<p>The key is to perform your verifications at the same level of abstraction as the component that you’re testing. <a href="http://www.sandimetz.com/">Sandi Metz</a> has a <a href="https://speakerdeck.com/skmetz/magic-tricks-of-testing-railsconf">great presentation about this</a> that describes simple rules to know when you are testing at the correct level.</p>

<p>When one first starts testing, it seems like the right thing to do is to test everything. This doesn’t achieve the real goal of tests, to allow one to confidently change things and know that you aren’t breaking them. When you test everything, you make it so nothing can be changed without breaking some test. Testing only your code and not anyone else’s helps your tests ensure your code’s reliability and also its flexibility.</p>

<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p>CRUD is an acronym for “Create, Read, Update, and Delete”, the standard set of database actions. <a href="#fnref1" rev="footnote">↩</a></p>
</li>

<li id="fn2">
<p>And that isn’t your job. Testing that the database works is the database developer’s job. <a href="#fnref2" rev="footnote">↩</a></p>
</li>

</ol>
</div>

</div>
</body></html>

          </div>
        </div>

        <div class="col-md-8 col-md-offset-2">
          <hr/>
          <div class="text-center">
            <p>
              <a href="mailto:lee@lee-dohm.com"><span class="octicon octicon-mail"></span></a>&nbsp;&nbsp;
              <a href="https://github.com/lee-dohm"><span class="octicon octicon-mark-github"></span></a>&nbsp;&nbsp;
              <a href="http://stackoverflow.com/users/1954/lee"><i class="fa fa-stack-exchange"></i></a>&nbsp;&nbsp;
              <a href="https://twitter.com/leedohm"><i class="fa fa-twitter"></i></a>
            </p>
            <p>
              Copyright &copy; 2010-2016 by Lee Dohm
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//code.jquery.com/jquery.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="/javascripts/lightbox.min.js"></script>
    <script src="/javascripts/bigfoot.min.js"></script>
    <script type="text/javascript">
      $.bigfoot();
    </script>
  </body>
</html>
